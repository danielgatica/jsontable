CREATE VIEW hana.vw_openbrand_pricings AS
SELECT 
    p.published_date as pricings_published_date,
    p.net_price as pricings_net_price,
    p.shelf_price as pricings_shelf_price,
    p.in_stock as pricings_in_stock,
    p.brand as pricings_brand,
    p.category_name as pricings_category_name,
    p.merchant as pricings_merchant,
    p.merchant_sku as pricings_merchant_sku,
    p.product as pricings_product,
    p.part_number as pricings_part_number,
    p.product_location as pricings_product_location,
    p.deleted as pricings_deleted,
    p.date_collected as pricings_date_collected,
    p.promo_percentage as pricings_promo_percentage,
    p.on_promo as pricings_on_promo,
    p.on_ad as pricings_on_ad,
    p.updated_at as pricings_updated_at,
    c.full_name as categories_full_name,
    c.frequency as categories_frequency,
    c.published_date as categories_published_date,
    c.ecom_price_change as categories_ecom_price_change,
    c.ecom_and_retail_com_channel_variance as categories_ecom_and_retail_com_channel_variance,
    c.track_zero_prices as categories_track_zero_prices,
    c.display_cents as categories_display_cents,
    c.publish_product_location as categories_publish_product_location,
    m."type" as merchants_type,
    m.channel as merchants_channel,
    m.country_code as merchants_country_code,
    prod.name as products_name,
    prod.brand_name as products_brand_name,
    prod.product_status as products_product_status,
    prod.product_version_id as products_product_version_id,
    prod.manufacturer_suggested_retail_price as products_manufacturer_suggested_retail_price,
    prod.estimated_retail_price as products_estimated_retail_price,
    prod.net_estimated_price as products_net_estimated_price,
    prod.average_online_price as products_average_online_price,
    prod.average_retail_dot_com_net_price as products_average_retail_dot_com_net_price,
    prod.average_retail_dot_com_weekly_net_price as products_average_retail_dot_com_weekly_net_price,
    prod.average_retail_net_price as products_average_retail_net_price,
    prod.average_retail_weekly_net_price as products_average_retail_weekly_net_price,
    prod.average_ecom_net_price as products_average_ecom_net_price,
    prod.average_ecom_weekly_net_price as products_average_ecom_weekly_net_price,
    prod.most_frequent_price as products_most_frequent_price,
    prod.most_frequent_weekly_price as products_most_frequent_weekly_price,
    prod.most_frequent_monthly_price as products_most_frequent_monthly_price,
    prod.most_frequent_retail_weekly_price as products_most_frequent_retail_weekly_price,
    prod.most_frequent_retail_net_price as products_most_frequent_retail_net_price,
    prod.deleted as products_deleted,
    -- Product specifications fields with appropriate aliases
    spec.third_rack as spec_third_rack,
    spec.ad_compliant as spec_ad_compliant,
    spec.ada_compliant as spec_ada_compliant,
    spec.additional_door_capabilities as spec_additional_door_capabilities,
    spec.appliance_type as spec_appliance_type,
    spec.auto_cook as spec_auto_cook,
    spec.auto_dose_dispenser as spec_auto_dose_dispenser,
    spec.base_color as spec_base_color,
    spec.bleach_dispenser as spec_bleach_dispenser,
    spec.brand as spec_brand,
    spec.broil_element_location as spec_broil_element_location,
    spec.built_in as spec_built_in,
    spec.burner_type as spec_burner_type,
    spec.cfm as spec_cfm,
    spec.capacity as spec_capacity,
    spec.capacity_cu_ft as spec_capacity_cu_ft,
    spec.capacity_range_cu_ft as spec_capacity_range_cu_ft,
    spec.child_lock as spec_child_lock,
    spec.cleaning_type as spec_cleaning_type,
    spec.cold_optimized as spec_cold_optimized,
    spec.color as spec_color,
    spec.compartment_divider_yes_no as spec_compartment_divider_yes_no,
    spec.configuration as spec_configuration,
    spec.console_design as spec_console_design,
    spec.control_type as spec_control_type,
    spec.convection as spec_convection,
    spec.convection_type as spec_convection_type,
    spec.cooktop as spec_cooktop,
    spec.cooktop_control_location as spec_cooktop_control_location,
    spec.cooktop_control_method as spec_cooktop_control_method,
    spec.cooktop_elements as spec_cooktop_elements,
    spec.cooktop_light as spec_cooktop_light,
    spec.cooktop_max_output as spec_cooktop_max_output,
    spec.counter_depth as spec_counter_depth,
    spec.cycles as spec_cycles,
    spec.dba_level as spec_dba_level,
    spec.defrost as spec_defrost,
    spec.defrost_type as spec_defrost_type,
    spec.depth as spec_depth,
    spec.depth_in as spec_depth_in,
    spec.depth_with_door_open_in as spec_depth_with_door_open_in,
    spec.depth_with_handles_in as spec_depth_with_handles_in,
    spec.detergent_dispenser as spec_detergent_dispenser,
    spec.digital_display as spec_digital_display,
    spec.display_type as spec_display_type,
    spec.door_window as spec_door_window,
    spec.door_in_door as spec_door_in_door,
    spec.double_oven as spec_double_oven,
    spec.downdraft_ventilation as spec_downdraft_ventilation,
    spec.drawer_type as spec_drawer_type,
    spec.electric_gas as spec_electric_gas,
    spec.element_sizes as spec_element_sizes,
    spec.energy_consumption_kwh_yr as spec_energy_consumption_kwh_yr,
    spec.energy_rating as spec_energy_rating,
    spec.energy_star as spec_energy_star,
    spec.evaporator as spec_evaporator,
    spec.exterior_water_and_ice_dispenser as spec_exterior_water_and_ice_dispenser,
    spec.fabric_softener_dispenser as spec_fabric_softener_dispenser,
    spec.fold_down_tines as spec_fold_down_tines,
    spec.food_disposer as spec_food_disposer,
    spec.form_factor as spec_form_factor,
    spec.freezer_capacity_cu_ft as spec_freezer_capacity_cu_ft,
    spec.fuel_type as spec_fuel_type,
    spec.gtin13 as spec_gtin13,
    spec.gallon_door_bins as spec_gallon_door_bins,
    spec.griddle as spec_griddle,
    spec.handle_color as spec_handle_color,
    spec.handle_type as spec_handle_type,
    spec.height as spec_height,
    spec.height_approx_in as spec_height_approx_in,
    spec.height_in as spec_height_in,
    spec.height_with_handles_in as spec_height_with_handles_in,
    spec.hidden_vent as spec_hidden_vent,
    spec.humidity_controlled_crispers as spec_humidity_controlled_crispers,
    spec.icemaker as spec_icemaker,
    spec.interior_color as spec_interior_color,
    spec.interior_finish as spec_interior_finish,
    spec.interior_material as spec_interior_material,
    spec.interior_refrigerator_light_type as spec_interior_refrigerator_light_type,
    spec.internal_water_heater as spec_internal_water_heater,
    spec.load_type as spec_load_type,
    spec.low_profile as spec_low_profile,
    spec.matching_washer_load_type as spec_matching_washer_load_type,
    spec.max_output as spec_max_output,
    spec.microwave_size_in as spec_microwave_size_in,
    spec.microwave_type as spec_microwave_type,
    spec.number_of_compartments as spec_number_of_compartments,
    spec.number_of_doors as spec_number_of_doors,
    spec.options as spec_options,
    spec.oven_capacity_cu_ft as spec_oven_capacity_cu_ft,
    spec.oven_racks as spec_oven_racks,
    spec.pod_dispenser as spec_pod_dispenser,
    spec.panel_material as spec_panel_material,
    spec.part_number as spec_part_number,
    spec.place_setting_capacity as spec_place_setting_capacity,
    spec.product_power as spec_product_power,
    spec.power_watts as spec_power_watts,
    spec.primary_oven_capacity_cu_ft as spec_primary_oven_capacity_cu_ft,
    spec.product as spec_product,
    spec.product_debut as spec_product_debut,
    spec.product_family as spec_product_family,
    spec.product_size as spec_product_size,
    spec.product_type as spec_product_type,
    spec.product_weight_lbs as spec_product_weight_lbs,
    spec.range_type as spec_range_type,
    spec.refrigerator_capacity_cu_ft as spec_refrigerator_capacity_cu_ft,
    spec.reheat as spec_reheat,
    spec.sabbath_mode_yes_no as spec_sabbath_mode_yes_no,
    spec.sanitize as spec_sanitize,
    spec.secondary_oven_capacity_cu_ft as spec_secondary_oven_capacity_cu_ft,
    spec.self_cleaning_filter as spec_self_cleaning_filter,
    spec.sensor as spec_sensor,
    spec.sensor_clean as spec_sensor_clean,
    spec.series as spec_series,
    spec.shelf_type as spec_shelf_type,
    spec.smart_appliance as spec_smart_appliance,
    spec.smart_home_compatibility_yes_no as spec_smart_home_compatibility_yes_no,
    spec.spill_proof_shelves as spec_spill_proof_shelves,
    spec.stackable as spec_stackable,
    spec.steam as spec_steam,
    spec.tall_door as spec_tall_door,
    spec.temperature_control_pantry as spec_temperature_control_pantry,
    spec.temperature_setting_options as spec_temperature_setting_options,
    spec.timer as spec_timer,
    spec.total_capacity_cu_ft as spec_total_capacity_cu_ft,
    spec.tub_material as spec_tub_material,
    spec.turntable as spec_turntable,
    spec.turntable_diameter_in as spec_turntable_diameter_in,
    spec.upc as spec_upc,
    spec.virtual_assistant_type as spec_virtual_assistant_type,
    spec.voice_control as spec_voice_control,
    spec.warranty as spec_warranty,
    spec.wash_mechanism as spec_wash_mechanism,
    spec.water_filter as spec_water_filter,
    spec.weight_lbs as spec_weight_lbs,
    spec.width as spec_width,
    spec.width_approx_in as spec_width_approx_in,
    spec.width_in as spec_width_in,
    spec.width_with_handles_in as spec_width_with_handles_in
FROM data.openbrand_pricings p
LEFT JOIN data.dim_openbrand_categories c 
    ON p.category_name = c.name
LEFT JOIN data.dim_openbrand_merchants m 
    ON p.merchant = m.name
LEFT JOIN data.dim_openbrand_products prod 
    ON p.part_number = prod.part_number 
    AND p.category_name = prod.category_name
LEFT JOIN dev.dim_openbrand_products_specification spec
    ON p.part_number = spec.part_number;
